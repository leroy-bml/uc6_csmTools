% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_soil_data.R
\name{get_soil_profile}
\alias{get_soil_profile}
\title{Retrieve and map a DSSAT soil profile for a target location}
\usage{
get_soil_profile(
  lon,
  lat,
  src = "soil_grids",
  dir = NULL,
  output_path = NULL,
  delete_raw_files = FALSE
)
}
\arguments{
\item{lon}{(numeric) Longitude (x coordinate) of the target location \link{decimal degrees E/W, range 6:15}}

\item{lat}{(numeric) Latitude (y coordinate) of the target location \link{decimal degrees N/S, range 47:55}}

\item{src}{(character) Source repository of the soil data (currently only "soil_grids" is supported)}

\item{dir}{(character) Directory in which to store and extract the profile data. If 'NULL', the raw files are saved in a temporary location
created in the working directory.}

\item{output_path}{(character) Optional file path to save the output.}
}
\value{
A list with elements \code{SOIL_METADATA}, \code{SOIL_PROFILES}, and \code{SOIL_PROFILE_LAYERS}, each as a data frame or list of data frames in ICASA format. A comment attribute is attached describing data provenance.
}
\description{
Downloads, extracts, and maps the closest SoilGrids soil profile to a specified latitude and longitude, returning the data in ICASA format.
}
\details{
The function downloads and extracts the SoilGrids by-country dataset if not already present, determines the country for the given coordinates using reverse geocoding, and loads the corresponding soil profile file. It selects the profile closest to the specified coordinates, splits the data into metadata, profile, and layer sections, and maps each section to the ICASA data model using a mapping file. The institution is set to "ISRIC" for provenance.

The function uses \code{get_soilGrids_dataverse}, \code{reverse_geocode}, \code{read_sol}, \code{map_data}, and \code{load_map} for data retrieval and transformation.
}
\examples{
\dontrun{
soil_profile <- get_soil_profile(lat = 40.7128, lon = -74.0060)
str(soil_profile)
}

}
