% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_sensor_data.R
\name{get_sensor_data}
\alias{get_sensor_data}
\title{Download and format sensor data from OGC SensorThings API endpoint}
\usage{
get_sensor_data(
  url,
  creds = NULL,
  var,
  lon,
  lat,
  radius,
  from,
  to,
  aggregate = "median",
  output_path = NULL
)
}
\arguments{
\item{url}{(character) The base URL of the OGC SensorThings API endpoint (should end with a slash).}

\item{creds}{(list) A named list containing Keycloak authentication details (see Details).}

\item{var}{(character vector) The names of observed properties (variables) to extract, as defined ObservedProperties on the focal STA endpoint.}

\item{lon}{(numeric) Longitude (x coordinate) of the target location \link{decimal degrees E/W, range 6:15}}

\item{lat}{(numeric) Latitude (y coordinate) of the target location \link{decimal degrees N/S, range 47:55}}

\item{radius}{(numeric) Search radius around the focal coordinates, in meters.}

\item{from}{(character or date) Start date of the desired time range as YYYY-MM-DD (inclusive).}

\item{to}{(character or date) End date of the desired time range as YYYY-MM-DD (inclusive).}

\item{aggregate}{(character) Method for consolidating data (e.g., \code{"median"}).}

\item{output_path}{(character) Optional file path to save the output.}
}
\value{
A consolidated data frame or output file depending on configuration.
}
\description{
Retrieves, merges, and formats observational data for specified variables, location, and time range from an OGC SensorThings API (STA) endpoint.
}
\details{
\strong{Credentials Structure:}
The \code{creds} argument must be a named list containing exactly these five keys:
\itemize{
\item \code{url}: The Keycloak token endpoint URL.
\item \code{client_id}: The registered Client ID.
\item \code{client_secret}: The Client Secret.
\item \code{username}: User's username.
\item \code{password}: User's password.
}

This function orchestrates the retrieval of datastream metadata and observations. It automatically obtains a token using the provided credentials.
}
\examples{
\dontrun{
# 1. Define credentials object
my_creds <- list(
  url = "https://auth.example.com/realms/main/protocol/openid-connect/token",
  client_id = "my_app_id",
  client_secret = "xyz_secret_123",
  username = "jdoe",
  password = "supersecretpassword"
)

# 2. Run extraction
data <- get_sensor_data(
  url = "https://example.com/SensorThings/v1.0/",
  creds = my_creds,
  var = c("air_temperature"),
  lon = 12.34, lat = 56.78, radius = 500,
  from = "2022-01-01", to = "2022-01-02"
)
}

}
