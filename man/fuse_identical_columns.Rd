% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/merge_tbls.R
\name{fuse_identical_columns}
\alias{fuse_identical_columns}
\title{Fuse Identical Columns in a Data Frame}
\usage{
fuse_identical_columns(df, sep = "-")
}
\arguments{
\item{df}{A data frame in which to fuse identical columns.}

\item{sep}{A character string used as the separator between the base name and suffix in column names (default: "-").}
}
\value{
A data frame with identical columns fused and a \code{flag} column indicating rows with non-identical values among columns with the same base name. If all rows are unflagged, the \code{flag} column is removed.
}
\description{
Identifies groups of columns in a data frame that share a common base name (differentiated by a separator and suffix)
and fuses (merges) columns that are identical, keeping only one representative per group.
Adds a flag column indicating rows where columns with the same base name are not identical.
}
\details{
The function:
\itemize{
\item Groups columns by their base name (before the separator).
\item For each group, flags rows where the values are not identical across columns.
\item Within each group, keeps only one representative column for each set of identical columns.
\item Renames the kept column to the base name if possible.
\item Adds a \code{flag} column listing base names with non-identical values in each row.
\item Removes the \code{flag} column if all values are \code{NA}.
}
}
\examples{
df <- data.frame(
  A = c(1, 2, 3),
  A-x = c(1, 2, 3),
  A-y = c(1, 2, 4),
  B = c("a", "b", "c"),
  B-x = c("a", "b", "c")
)
fuse_identical_columns(df)

}
