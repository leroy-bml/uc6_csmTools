% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_transform_iot.R
\name{locate_sta_datastreams}
\alias{locate_sta_datastreams}
\title{Locate OGC SensorThings Datastreams by Location, Variable, and Timeframe}
\usage{
locate_sta_datastreams(
  url,
  token = NULL,
  var,
  lon,
  lat,
  radius = 0,
  from,
  to,
  ...
)
}
\arguments{
\item{url}{Character. The base URL of the OGC SensorThings API endpoint (should end with a slash).}

\item{token}{Character or NULL. The Bearer token for authentication, or NULL if not required.}

\item{var}{Character vector. The names of observed properties (variables) to search for (e.g., \code{c("air_temperature", "solar_radiation", "rainfall")}).}

\item{lon}{Numeric. Longitude of the target location.}

\item{lat}{Numeric. Latitude of the target location.}

\item{from}{Character or Date. Start date of the desired time range (inclusive).}

\item{to}{Character or Date. End date of the desired time range (inclusive).}

\item{...}{Additional arguments passed to internal functions.}
}
\value{
A data frame of matching datastreams, or a character message if no data is found for the specified criteria.
}
\description{
Queries an OGC SensorThings API endpoint to find datastreams at a specified longitude and latitude, for selected observed properties, and within a given time range.
}
\details{
The function first identifies all devices (Things) from the SensorThings API, extracting their locations. It then retrieves all datastreams for devices at the specified coordinates, including metadata about observed properties and measurement periods. It filters datastreams to those matching the requested observed properties (\code{var}) and checks if their measurement periods encompass the requested time range (\code{from} to \code{to}).

The function returns a data frame of matching datastreams, or a message if no suitable data is found.

The function uses the \strong{httr}, \strong{jsonlite}, \strong{dplyr}, \strong{tidyr}, and \strong{tibble} packages.
}
\examples{
\dontrun{
locate_sta_datastreams(
  url = "https://example.com/SensorThings/v1.0/",
  token = "your_access_token",
  var = c("air_temperature", "rainfall"),
  lon = 12.34,
  lat = 56.78,
  from = "2022-01-01",
  to = "2022-12-31"
)
}

}
