% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/assemble_dataset.R
\name{assemble_dataset}
\alias{assemble_dataset}
\title{Assemble dataset from multiple components}
\usage{
assemble_dataset(
  components = list(),
  keep_all = FALSE,
  action = "merge_properties",
  output_path = NULL,
  join_type = "full",
  groups = NULL,
  agg_fun = "coalesce"
)
}
\arguments{
\item{components}{(list) List of data components to assemble. Each component should be a named list
containing data frames/tables.}

\item{keep_all}{(logical) If \code{TRUE}, preserves all unique components in the output structure.
If \code{FALSE} (default), uses the structure of the first component as template.}

\item{action}{(Character) Integration strategy to apply when combining components with matching names:
\describe{
\item{"merge_properties"}{(default) Merge columns (properties) using specified join type (default)}
\item{"aggregate_records"}{Combine rows (records) with optional grouping and aggregation}
\item{"replace_table"}{Use the most recent component, discarding previous versions}
}}

\item{output_path}{(character) Optional file path to save the output.}

\item{join_type}{(character) Join type to use when \code{action = "merge_properties"}.
Supports: \code{"full"} (default), \code{"left"}, \code{"right"}, \code{"inner"}.}

\item{groups}{(character) Vector of column names to group by when \code{action = "aggregate_records"}.
If \code{NULL} (default), no grouping is performed.}

\item{agg_fun}{(character|function) Aggregation function to use when \code{action = "aggregate_records"}.
Can be a function or name of function like \code{"coalesce"} (default), \code{"mean"}, etc.}
}
\value{
A structured list containing the assembled dataset
}
\description{
Combines multiple data components into a unified dataset structure with flexible integration strategies.
Handles attribute preservation, key normalization, and different merging approaches.
}
\details{
The assembly process follows these steps:
\enumerate{
\item Resolves and flattens input components
\item Preserves custom attributes from input data
\item Determines output structure based on \code{keep_all} parameter
\item Normalizes keys to leaf names only (removes path prefixes)
\item Applies the specified integration action to components with matching names
\item Reconstructs the final nested structure
\item Restores custom attributes using object names, and exports if path is provided
}
}
\examples{
\dontrun{
# Basic column merging (default)
assembled <- assemble_dataset(
  components = list(soil_data, weather_data, management_data),
  action = "merge_properties"
)

# Row aggregation with grouping
assembled <- assemble_dataset(
  components = list(exp1_results, exp2_results),
  action = "aggregate_records",
  groups = c("treatment", "year"),
  agg_fun = "mean"
)

# Replace strategy (use newest version)
assembled <- assemble_dataset(
  components = list(old_version, new_version),
  action = "replace_table"
)

# Save directly to file
assemble_dataset(
  components = my_components,
  output_path = "path/to/assembled_dataset.rds"
)
}

}
