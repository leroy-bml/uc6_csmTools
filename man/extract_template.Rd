% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_transform_template.R
\name{extract_template}
\alias{extract_template}
\title{Extract and Process Data from a the ICASA Template Workbook}
\usage{
extract_template(
  path = NULL,
  exp_id = NA_character_,
  headers = c("short", "long"),
  keep_null_events = TRUE,
  keep_empty = TRUE
)
}
\arguments{
\item{path}{Character. Path to the template Excel workbook.}

\item{exp_id}{Character vector or NA. Experiment ID(s) to extract. If NA (default), all experiments are returned.}

\item{headers}{Character. Which column header format to use in the output: \code{"short"} (default) or \code{"long"}.}
}
\value{
A named list of experiments, each containing a list of processed data frames for each section of the template.
}
\description{
Loads, cleans, and processes data from the ICASA template Excel workbook, mapping descriptions to ICASA codes and formatting according to the ICASA data model.
}
\details{
The function loads the workbook, extracts all relevant (capitalized) sheets, and cleans each data frame by removing artefact columns and rows. It maps template dropdown list descriptions to ICASA codes, deletes empty data frames, and formats treatment and event tables. Metadata is structured according to the ICASA data model. If \code{headers} is \code{"short"}, column names are mapped to their short format using the template dictionary.

The function returns a list of experiments, each as a list of processed data frames.

The function uses several helper functions, including \code{wb_load}, \code{wb_get_sheet_names}, \code{wb_to_df}, \code{drop_artefacts}, \code{get_template_codes}, \code{desc_to_codes}, \code{format_envmod_tbl}, \code{format_treatment_str}, \code{format_events}, \code{structure_metadata}, \code{icasa_long_to_short}, and \code{split_experiments}.
}
\examples{
\dontrun{
out <- extract_template("template.xlsx")
names(out)
# [1] "EXP001" "EXP002" ...
}

}
