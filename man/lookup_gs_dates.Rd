% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lookup_gs_dates.R
\name{lookup_gs_dates}
\alias{lookup_gs_dates}
\title{Lookup cereal growth stage dates}
\usage{
lookup_gs_dates(
  data,
  gs_scale = "bbch",
  gs_codes = NULL,
  date_select_rule = c("median", "first", "last", "all"),
  output_path = NULL
)
}
\arguments{
\item{data}{Data frame containing phenological observations including the following columns:
\itemize{
\item \code{Date} (character or Date) - Observation dates in DD/MM/YYYY format
\item \code{Growth_Stage} (character) - Growth stage names (must match the terminology of 'gs_scale' data). See data(growth_stages) for
details.
}}

\item{gs_scale}{(character) Growth stage scale to use.
\itemize{
\item \code{bbch} BBCH scale for cereals
\item \code{zadoks} Zadoks scale for cereals
}}

\item{gs_codes}{(numeric) Optional vector of specific growth stage codes to extract. If \code{NULL} (default), all available codes are used.}

\item{date_select_rule}{(character) Rule for selecting dates when multiple observations exist for a growth stage. Options:
\itemize{
\item \code{"median"} (default) - Use median date
\item \code{"first"} - Use earliest date
\item \code{"last"} - Use latest date
\item \code{"all"} - Return all dates
}}

\item{output_path}{(character) Optional path to save output. If \code{NULL} (default), returns data as a list.}
}
\value{
A named list containing:
\itemize{
\item \code{CEREAL_PHENOLOGY}: Data frame with columns:
\itemize{
\item \code{scale} - Growth stage scale used
\item \code{growth_stage} - Growth stage name
\item \code{scaled_code} - Standardized growth stage code
\item \code{doy} - Day of year
\item \code{Date} - Original date
\item \code{date} - Processed date (when applicable)
\item \code{year} - Year (when applicable)
}
}
If \code{output_path} is specified, saves to files in addition to returning the list
}
\description{
Extracts and standardizes growth stage dates from phenological data using specified growth stage scales (e.g., BBCH) and selection rules.
}
\details{
The function:
\enumerate{
\item Maps growth stages to standardized codes using reference scales
\item Calculates scaled codes within each growth stage range
\item Applies selected rule to handle multiple observations
\item Returns dates in both original and day-of-year formats
}

Scaled codes are calculated by linearly interpolating between the minimum and maximum codes for each growth stage based on the
relative position of each observation date within the stage's date range.
}
\examples{
# Using default BBCH scale with median dates
gs_dates <- lookup_gs_dates(phenology_data)

# Get first observation dates for specific codes
gs_dates <- lookup_gs_dates(
  phenology_data,
  gs_codes = c(30, 65, 89),
  date_select_rule = "first"
)

# Save all observations to file
lookup_gs_dates(phenology_data, date_select_rule = "all",
               output_path = "gs_dates_output/")

}
