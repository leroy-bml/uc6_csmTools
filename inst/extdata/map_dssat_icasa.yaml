# DSSAT to ICASA data map (v0.0.9; verbose)

# =================================================================
# DEFINITIONS & ANCHORS
#
# Code lists ('xxx_codes') are provided as identity maps (input and
# output codes identical) for data validation and flexibility
# Actual maps ('xxx_map') describes different input and output codes
# =================================================================

definitions:
  
  drainage_type_codes: &drainage_type_codes
    'DR000': 'DR000'  # No drainage
    'DR001': 'DR001'  # Ditches
    'DR002': 'DR002'  # Sub-surface tiles
    'DR003': 'DR003'  # Surface furrows
  drainage_type_default: &drainage_type_default NA
  
  soil_analysis_method_codes: &soil_analysis_method_codes  # Note 2025-09-02: redundant codes (missing method); split by assay (ph, P, K)?
    'SA001': 'SA001'  # Olsen
    'SA002': 'SA002'  # Bray No. 1
    'SA003': 'SA003'  # Bray No. 2
    'SA004': 'SA004'  # Mehlich 1 (double acid, 1:5)
    'SA005': 'SA005'  # Anion exchange resin
    'SA006': 'SA006'  # Truog
    'SA007': 'SA007'  # Mehlich 1 (double acid, 1:10)
    'SA008': 'SA008'  # Colwell
    'SA009': 'SA009'  # Water
    'SA010': 'SA010'  # IFDC Pi strip
    'SA011': 'SA011'  # pH in Water
    'SA012': 'SA012'  # pH in KCl
    'SA013': 'SA013'  # Mehlich 3
    'SA014': 'SA014'  # Morgan's solution
    'SA015': 'SA015'  # NH4OAc
    'SA099': 'SA099'  # Method unknown/not given (Phosphorus)
    # 'SA101': 'SA101'  # -- Definition missing (ICASA placeholder for pH methods)
    # 'SA102': 'SA102'  # -- Definition missing (ICASA placeholder for pH methods)
    # 'SA103': 'SA103'  # -- Definition missing (ICASA placeholder for pH methods)
    # 'SA104': 'SA104'  # -- Definition missing (ICASA placeholder for pH methods)
    # 'SA105': 'SA105'  # -- Definition missing (ICASA placeholder for pH methods)
    'SA199': 'SA199'  # Method unknown/not given (pH)
    'SA201': 'SA201'  # NH4OAc
    'SA202': 'SA202'  # Mehlich 1 (1:5)
    'SA203': 'SA203'  # Mehlich 1 (1:10)
    'SA204': 'SA204'  # Mehlich 3
    'SA299': 'SA299'   # Method unknown/not given (Potassium)
  soil_ph_method_default: &soil_ph_method_default SA199
  soil_p_method_default: &soil_p_method_default SA099
  soil_k_method_default: &soil_k_method_default SA299

  planting_material_codes: &planting_material_codes   #CHECK TO ADD TO RULE!
    'S': 'S'   # Dry seed  
    'T': 'T'   # Transplants  
    'N': 'N'   # Nursery  
    'P': 'P'   # Pregerminated seed  
    'R': 'R'   # Ratoon  
    'V': 'V'   # Vertically planted sticks  
    'H': 'H'   # Horizontally planted sticks  
    'I': 'I'   # Inclined (45o) sticks  
    'C': 'C'   # Cutting  
    'B': 'B'   # Bedded | Note 2025-09-03: DSSAT code not in ICASA; definition issue: defined in DSSAT key as planting_material/method rather than distribution (cf. rule no ##)
  planting_material_default: &planting_material_default NA
  
  planting_distribution_codes: &planting_distribution_codes
    'R': 'R'    # Rows  
    # 'RB': 'RB'  # Rows on beds  
    'H': 'H'    # Hills  
    'U': 'U'    # Uniform/Broadcast  
    # 'P': 'P'    # Pots  
    # 'N': 'N'    # Unknown/not given
  planting_distribution_default: &planting_distribution_default NA

  application_method_codes: &application_method_codes
    'AP001': 'AP001'   # Broadcast, not incorporated  
    'AP002': 'AP002'   # Broadcast, incorporated  
    'AP003': 'AP003'   # Banded on surface  
    'AP004': 'AP004'   # Banded beneath surface  
    'AP005': 'AP005'   # Applied in irrigation water  
    'AP006': 'AP006'   # Foliar spray  
    'AP007': 'AP007'   # Bottom of hole, deep placement  
    'AP008': 'AP008'   # On the seed  
    'AP009': 'AP009'   # Injected  
    'AP011': 'AP011'   # Broadcast on flooded/saturated soil, none in soil  
    'AP012': 'AP012'   # Broadcast on flooded/saturated soil, 15% in soil  
    'AP013': 'AP013'   # Broadcast on flooded/saturated soil, 30% in soil  
    'AP014': 'AP014'   # Broadcast on flooded/saturated soil, 45% in soil  
    'AP015': 'AP015'   # Broadcast on flooded/saturated soil, 60% in soil  
    'AP016': 'AP016'   # Broadcast on flooded/saturated soil, 75% in soil  
    'AP017': 'AP017'   # Broadcast on flooded/saturated soil, 90% in soil  
    'AP018': 'AP018'   # Band on saturated soil, 2cm flood, 92% in soil  
    'AP019': 'AP019'   # Deeply placed urea super granules/pellets, 95% in soil  
    'AP020': 'AP020'   # Deeply placed urea super granules/pellets, 100% in soil  
    'AP999': 'AP999'   # Application method unknown/not given
  application_method_default: &application_method_default AP999

  fertilizer_material_codes: &fertilizer_material_codes
    'FE001': 'FE001'   # Ammonium nitrate  
    'FE002': 'FE002'   # Ammonium sulfate  
    'FE003': 'FE003'   # Ammonium nitrate sulfate  
    'FE004': 'FE004'   # Anhydrous ammonia  
    'FE005': 'FE005'   # Urea  
    'FE006': 'FE006'   # Diammonium phosphate (DAP)  
    'FE007': 'FE007'   # Monoammonium phosphate (MAP)  
    'FE008': 'FE008'   # Calcium nitrate  
    'FE009': 'FE009'   # Aqua ammonia  
    'FE010': 'FE010'   # Urea ammonium nitrate  
    'FE011': 'FE011'   # Calcium ammonium nitrate  
    'FE012': 'FE012'   # Ammonium poly-phosphate  
    'FE013': 'FE013'   # Single super phosphate  
    'FE014': 'FE014'   # Triple super phosphate (TSP)  
    'FE015': 'FE015'   # Liquid phosphoric acid  
    'FE016': 'FE016'   # Potassium chloride (muriate of potash, MOP)  
    'FE017': 'FE017'   # Potassium nitrate (nitrate of potash)  
    'FE018': 'FE018'   # Potassium sulfate  
    'FE019': 'FE019'   # Urea super granules  
    'FE020': 'FE020'   # Dolomitic limestone  
    'FE021': 'FE021'   # Rock phosphate  
    'FE022': 'FE022'   # Calcitic limestone  
    'FE023': 'FE023'   # Urea ammonium sulfate  
    'FE024': 'FE024'   # Rhizobium  
    'FE026': 'FE026'   # Calcium hydroxide (hydrated lime)  
    'FE027': 'FE027'   # NPK - ammonium nitrate  
    'FE028': 'FE028'   # NPK - urea  
    'FE029': 'FE029'   # NPK - ammonium nitrate urea  
    'FE030': 'FE030'   # NPK - user blend  
    'FE036': 'FE036'   # 32% UAN (35% urea + 45% A.N.)  
    'FE037': 'FE037'   # 30% UAN (33% urea + 42% A.N.)  
    'FE038': 'FE038'   # 28% UAN (30% urea + 40% A.N.)  
    'FE039': 'FE039'   # 21% AN (60% A.N. + 40% water)  
    'FE040': 'FE040'   # 19% AN (54% A.N. + 46% water)  
    'FE041': 'FE041'   # Ammonium nitrate limestone  
    'FE042': 'FE042'   # Ammonionated super phosphate  
    'FE043': 'FE043'   # Ammonium phosphate nitrate  
    'FE044': 'FE044'   # Ammonium phosphate sulfate  
    'FE045': 'FE045'   # Urea ammonium phosphate  
    'FE046': 'FE046'   # Urea phosphate  
    'FE050': 'FE050'   # Calcium cyanamide  
    'FE051': 'FE051'   # Calcium nitrate-urea  
    'FE055': 'FE055'   # Sodium nitrate  
    'FE056': 'FE056'   # Magnesium nitrate  
    'FE057': 'FE057'   # Ammonium thiosulfate** (60% solution)  
    'FE058': 'FE058'   # Ammonium polysulfide  
    'FE059': 'FE059'   # Ammonium sulfate solution  
    'FE060': 'FE060'   # Ammonium sulfate - nitrate  
    'FE061': 'FE061'   # Ferrous ammonium sulfate  
    'FE062': 'FE062'   # Liquid ammonium polyphosphate  
    'FE063': 'FE063'   # Nitric phosphate  
    'FE064': 'FE064'   # Nitric acid  
    'FE065': 'FE065'   # Urea solution  
    'FE066': 'FE066'   # Zinc ammonium sulfate solution  
    'FE067': 'FE067'   # Zinc manganese ammonium sulfate  
    'FE068': 'FE068'   # Ammonium metaphosphate  
    'FE069': 'FE069'   # Ammonium phosphate  
    'FE070': 'FE070'   # Potassium - sodium nitrate  
    'FE201': 'FE201'   # ESN  
    'FE202': 'FE202'   # NBTPT  
    'FE203': 'FE203'   # DCD (dicyandiamide)  
    'FE204': 'FE204'   # SuperU  
    'FE205': 'FE205'   # DMPP (3,4-Dimethylpyrazole phosphate)  
    'FE206': 'FE206'   # Sulfur coated urea (thin coat)  
    'FE207': 'FE207'   # Sulfur coated urea (thick coat)  
    'FE208': 'FE208'   # ESN + NBTPT  
    'FE209': 'FE209'   # Ureaform (urea + formaldehyde)  
    'FE210': 'FE210'   # Crotonylidene diurea (CDU)  
    'FE211': 'FE211'   # Isobutylidene diurea (IBDU)  
    'FE212': 'FE212'   # Methylene ureas  
    'FE300': 'FE300'   # Mono potassium phosphate (MKP)  
    'FE301': 'FE301'   # Superphosphoric acid  
    'FE302': 'FE302'   # Calcium metaphosphate  
    'FE303': 'FE303'   # Potassium metaphosphate  
    'FE304': 'FE304'   # Precipitated phosphate  
    'FE305': 'FE305'   # Magnesium ammonium phosphate (struvite)  
    'FE306': 'FE306'   # Bone meal (steamed)  
    'FE307': 'FE307'   # Superphosphate, enriched  
    'FE308': 'FE308'   # Basic Lime phosphate  
    'FE309': 'FE309'   # Magnesium phosphate  
    'FE310': 'FE310'   # Limestone, phosphatic  
    'FE311': 'FE311'   # Basic slag  
    'FE312': 'FE312'   # Colloidal phosphate (Soft)  
    'FE400': 'FE400'   # Potash suspensions  
    'FE401': 'FE401'   # Potassium carbonate K2CO3 solid  
    'FE402': 'FE402'   # Potassium carbonate K2CO3 liquid  
    'FE403': 'FE403'   # Potassium magnesium sulfate**  
    'FE404': 'FE404'   # Manure salts  
    'FE405': 'FE405'   # Kainite KMg(SO4)ClÂ·3H2O  
    'FE406': 'FE406'   # Carnallite (hydrated potassium magnesium chloride)  
    'FE407': 'FE407'   # Lime-potash mixtures  
    'FE408': 'FE408'   # Greensand  
    'FE500': 'FE500'   # Wettable S  
    'FE501': 'FE501'   # Flowable S  
    'FE502': 'FE502'   # Flowers of S  
    'FE503': 'FE503'   # Gypsum  
    'FE504': 'FE504'   # Magnesium sulfate (epsom salt)  
    'FE505': 'FE505'   # Magnesium sulfate (Kieserite)  
    'FE506': 'FE506'   # Sulfuric acid  
    'FE507': 'FE507'   # Copper sulfate  
    'FE508': 'FE508'   # Aluminum sulfate  
    'FE509': 'FE509'   # Cobalt sulfate  
    'FE510': 'FE510'   # Ferric sulfate  
    'FE511': 'FE511'   # Ferrous sulfate  
    'FE512': 'FE512'   # Calcium sulfate (hydrous)  
    'FE513': 'FE513'   # Lime sulfur solution  
    'FE600': 'FE600'   # Magnesia (Magnesium oxide)  
    'FE601': 'FE601'   # Brucite (Magnesium hydroxide)  
    'FE602': 'FE602'   # Magnesium chelate  
    'FE620': 'FE620'   # Calcium chloride  
    'FE621': 'FE621'   # Calcium oxide (burned lime, quicklime)  
    'FE622': 'FE622'   # Selma chalk  
    'FE623': 'FE623'   # Calcium chelate  
    'FE640': 'FE640'   # Borax  
    'FE641': 'FE641'   # Boric acid  
    'FE660': 'FE660'   # Zinc sulfate monohydrate  
    'FE661': 'FE661'   # Zinc sulfate heptahydrate  
    'FE662': 'FE662'   # Zinc oxysulfate  
    'FE663': 'FE663'   # Basic zinc sulfate  
    'FE664': 'FE664'   # Zinc oxide  
    'FE665': 'FE665'   # Zinc carbonate  
    'FE666': 'FE666'   # Zinc chloride  
    'FE667': 'FE667'   # Zinc nitrate  
    'FE668': 'FE668'   # Zinc phosphate  
    'FE669': 'FE669'   # Zonc frits  
    'FE670': 'FE670'   # Ammoniated zinc  
    'FE680': 'FE680'   # Manganese agstone  
    'FE681': 'FE681'   # Manganese chelate  
    'FE682': 'FE682'   # Manganese oxide  
    'FE683': 'FE683'   # Manganese slag  
    'FE684': 'FE684'   # Manganese sulfate  
    'FE685': 'FE685'   # Manganous oxide  
    'FE700': 'FE700'   # Iron chelate  
    'FE701': 'FE701'   # Iron compound  
    'FE702': 'FE702'   # Ferric oxide  
    'FE720': 'FE720'   # Copper oxide, black  
    'FE721': 'FE721'   # Copper oxide, red  
    'FE722': 'FE722'   # Copper chelate  
    'FE723': 'FE723'   # Copper compound  
    'FE740': 'FE740'   # Sodium molybdonate  
    'FE900': 'FE900'   # Generic fertilizer
  fertilizer_material_default: &fertilizer_material_default FE900

  organic_material_codes: &organic_material_codes
    'RE001': 'RE001'   # Generic crop residue  
    'RE002': 'RE002'   # Green manure  
    'RE003': 'RE003'   # Barnyard manure  
    'RE004': 'RE004'   # Liquid manure  
    'RE005': 'RE005'   # Compost  
    'RE006': 'RE006'   # Bark  
    'RE101': 'RE101'   # Generic legume residue  
    'RE102': 'RE102'   # Cowpea residue  
    'RE103': 'RE103'   # Mucuna residue  
    'RE104': 'RE104'   # Peanut residue  
    'RE105': 'RE105'   # Pigeon Pea residue  
    'RE106': 'RE106'   # Soybean residue  
    'RE107': 'RE107'   # Alfalfa residue  
    'RE108': 'RE108'   # Chickpea forage  
    'RE109': 'RE109'   # Faba bean  
    'RE110': 'RE110'   # Pea residue  
    'RE111': 'RE111'   # Hairy vetch  
    'RE201': 'RE201'   # Generic cereal crop residue  
    'RE202': 'RE202'   # Pearl millet residue  
    'RE203': 'RE203'   # Maize residue  
    'RE204': 'RE204'   # Sorghum residue  
    'RE205': 'RE205'   # Wheat residue  
    'RE206': 'RE206'   # Barley  
    'RE207': 'RE207'   # Rice  
    'RE208': 'RE208'   # Rye  
    'RE301': 'RE301'   # Generic grass  
    'RE302': 'RE302'   # Bahiagrass  
    'RE303': 'RE303'   # Bermudagrass  
    'RE304': 'RE304'   # Switchgrass  
    'RE305': 'RE305'   # brachiaria  
    'RE306': 'RE306'   # forage grasses  
    'RE401': 'RE401'   # Bush fallow residue  
    'RE402': 'RE402'   # Sugarcane  
    'RE403': 'RE403'   # Pineapple  
    'RE404': 'RE404'   # Cassava | Note 2025-09-02: in DSSAT but not in ICASA  
    'RE999': 'RE999'   # Decomposed crop residue
  organic_material_default: &organic_material_default RE999

  chemical_material_codes: &chemical_material_codes
    'CH001': 'CH001'   # Alachlor (Lasso), Metolachlor (Dual) [Herbicide]  
    'CH002': 'CH002'   # Propanil [Herbicide]  
    'CH003': 'CH003'   # Trifluralin [Herbicide]  
    'CH004': 'CH004'   # Dalapon [Herbicide]  
    'CH005': 'CH005'   # MCPA [Herbicide]  
    'CH006': 'CH006'   # 2,4-D [Herbicide]  
    'CH007': 'CH007'   # 2,4,5-T [Herbicide]  
    'CH008': 'CH008'   # Pendimethalin [Herbicide]  
    'CH009': 'CH009'   # Atrazine [Herbicide]  
    'CH010': 'CH010'   # Diquat [Herbicide]  
    'CH011': 'CH011'   # Paraquat [Herbicide]  
    'CH012': 'CH012'   # Glyphosate [Herbicide]  
    'CH021': 'CH021'   # Carbaryl, Sevin, Septene [Insecticide]  
    'CH022': 'CH022'   # Malathion, Mercaptothion [Insecticide]  
    'CH023': 'CH023'   # Naled [Insecticide]  
    'CH024': 'CH024'   # Dimethoate [Insecticide]  
    'CH025': 'CH025'   # Fention [Insecticide]  
    'CH026': 'CH026'   # Diazinon, Basudin [Insecticide]  
    'CH027': 'CH027'   # Ethion, Diethion [Insecticide]  
    'CH028': 'CH028'   # Oxydemeton-Methyl [Insecticide]  
    'CH029': 'CH029'   # Azinphos-Methyl [Insecticide]  
    'CH030': 'CH030'   # Phosphamidon [Insecticide]  
    'CH031': 'CH031'   # Mevinphosl [Insecticide]  
    'CH032': 'CH032'   # Methyl Parathion [Insecticide]  
    'CH033': 'CH033'   # Parathion [Insecticide]  
    'CH034': 'CH034'   # DDT [Insecticide]  
    'CH035': 'CH035'   # BHC, HCH [Insecticide]  
    'CH036': 'CH036'   # Chlordane [Insecticide]  
    'CH037': 'CH037'   # Heptachlor [Insecticide]  
    'CH038': 'CH038'   # Toxaphene [Insecticide]  
    'CH039': 'CH039'   # Aldrin [Insecticide]  
    'CH040': 'CH040'   # Dieldrin [Insecticide]  
    'CH041': 'CH041'   # Endrin, Nendrin [Insecticide]  
    'CH042': 'CH042'   # Methomyl, Lannat [Insecticide]  
    'CH043': 'CH043'   # Thiotex [Insecticide]  
    'CH044': 'CH044'   # Furadan [Insecticide]  
    'CH045': 'CH045'   # Endosulfan [Insecticide]  
    'CH051': 'CH051'   # Captan [Fungicide]  
    'CH052': 'CH052'   # Benomyl [Fungicide]  
    'CH053': 'CH053'   # Zineb [Fungicide]  
    'CH054': 'CH054'   # Maneb [Fungicide]  
    'CH055': 'CH055'   # Mancozeb [Fungicide]  
    'CH056': 'CH056'   # Tilt [Fungicide]  
    'CH057': 'CH057'   # Rhizobium (for legume crops)  
    'CH100': 'CH100'   # Mepiquat Chloride (Pix) [Growth Regulator]  
    'CH101': 'CH101'   # Ethephon [Growth Regulator]  
    'CH102': 'CH102'   # Ethylene [Growth Regulator]  
    'CH201': 'CH201'   # Chlorantraniliprole (Coragen) [Insecticide]
  chemical_material_default: &chemical_material_default NA
  
  tillage_implement_codes: &tillage_implement_codes
    'TI001': 'TI001'   # V-Ripper  
    'TI002': 'TI002'   # Subsoiler  
    'TI003': 'TI003'   # Moldboard plow 20 cm depth  
    'TI004': 'TI004'   # Chisel plow, sweeps  
    'TI005': 'TI005'   # Chisel plow, straight point  
    'TI006': 'TI006'   # Chisel plow, twisted shovels  
    'TI007': 'TI007'   # Disk plow  
    'TI008': 'TI008'   # Disk, 1-way  
    'TI009': 'TI009'   # Disk, tandem  
    'TI010': 'TI010'   # Disk, double disk  
    'TI011': 'TI011'   # Cultivator, field  
    'TI012': 'TI012'   # Cultivator, row  
    'TI013': 'TI013'   # Cultivator, ridge till  
    'TI014': 'TI014'   # Harrow, spike  
    'TI015': 'TI015'   # Harrow, tine  
    'TI016': 'TI016'   # Lister  
    'TI017': 'TI017'   # Bedder  
    'TI018': 'TI018'   # Blade cultivator  
    'TI019': 'TI019'   # Fertilizer applicator, anhydrous  
    'TI020': 'TI020'   # Manure injector  
    'TI021': 'TI021'   # Animal-drawn implement  
    'TI022': 'TI022'   # Mulch treader  
    'TI023': 'TI023'   # Plank  
    'TI024': 'TI024'   # Roller packer  
    'TI025': 'TI025'   # Drill, double-disk  
    'TI026': 'TI026'   # Drill, deep furrow  
    'TI031': 'TI031'   # Drill, no-till  
    'TI032': 'TI032'   # Drill, no-till [sod]  
    'TI033': 'TI033'   # Planter, row  
    'TI034': 'TI034'   # Planter, no-till  
    'TI035': 'TI035'   # Planting stick (hand)  
    'TI036': 'TI036'   # Matraca hand planter  
    'TI037': 'TI037'   # Rod weeder  
    'TI038': 'TI038'   # Rotary hoe  
    'TI039': 'TI039'   # Roller harrow, cultipacker  
    'TI041': 'TI041'   # Moldboard plow 25 cm  
    'TI042': 'TI042'   # Moldboard plow 30 cm  
    'TI043': 'TI043'   # Strip tillage  
    'TI044': 'TI044'   # Laser leveling
  tillage_implement_default: &tillage_implement_default

  irrigation_codes: &irrigation_codes
    'IR001': 'IR001'   # Furrow, mm  
    'IR002': 'IR002'   # Alternating furrows, mm  
    'IR003': 'IR003'   # Flood, mm  
    'IR004': 'IR004'   # Sprinkler, mm  
    'IR005': 'IR005'   # Drip or trickle, mm  
    'IR006': 'IR006'   # Flood depth, mm  
    'IR007': 'IR007'   # Water table depth, mm  
    'IR008': 'IR008'   # Percolation rate, mm day-1  
    'IR009': 'IR009'   # Bund height, mm  
    'IR010': 'IR010'   # Puddling (for Rice only)  
    'IR011': 'IR011'   # Constant flood depth, mm  
    'IR012': 'IR012'   # Subsurface (burried) drip, mm  
    'IR999': 'IR999'   # Irrigation method unknown/not given
  irrigation_default: &irrigation_default IR999

  harvest_method_codes: &harvest_method_codes
    'HM001': 'HM001'   # Combined  
    'HM002': 'HM002'   # Hand cut, machine threshed  
    'HM003': 'HM003'   # Hand cut, hand threshed  
    'HM004': 'HM004'   # Hand picked, no further processing  
    'HM005': 'HM005'   # Hand picked, machine processing  
    'HM006': 'HM006'   # Cotton stripper  
    'HM999': 'HM999'   # Method unknown/not given
  harvest_method_default: &harvest_method_default HM999

  harvest_size_codes: &harvest_size_codes
    'A': 'A'   # All  
    'S': 'S'   # Small - less than 1/3 full size  
    'M': 'M'   # Medium - from 1/3 to 2/3 full size  
    'L': 'L'   # Large - greater than 2/3 full size
  harvest_size_default: &harvest_size_default NA

  soil_texture_map: &soil_texture_map
    'C': 'CL'       # Clay
    'CL': 'CLLO'    # Clay loam
    'L': 'LO'       # Loam
    'LS': 'LOSA'    # Loamy sand
    'S': 'SA'       # Sand
    'SC': 'SACL'    # Sandy clay  # Note 2025-09-02: error in DSSAT key (silty clay)
    'SCL': 'SACLL'  # Sandy clay loam
    'SL': 'SALO'    # Sandy loam
    'SI': 'SI'      # Silt
    'SIC': 'SICL'   # Silty clay
    'SICL': 'SICLL' # Silty clay loam
    'SIL': 'SILO'   # Silty loam
  soil_texture_default: &soil_texture_default NA

  crop_name_map: &crop_name_map
    #'ACK'   # Artichoke
    #'ALD'   # Almond
    'AL': 'ALF'   # Alfalfa
    #'AMR'   # Amaranth
    'AM': 'APL'   # Apple
    'AP': 'APR'   # Apricot
    #'ASP'   # Asparagus
    #'AVC'   # Avocado
    'BA': 'BAR'   # Barley
    #'BBR'   # Blueberry
    #'BGR'   # Bitter gourd
    'BH': 'BHG'   # Bahia grass
    'BW': 'BLW'   # Broad leaf weeds
    'BM': 'BMD'   # Bermudagrass
    'BG': 'BMG'   # Bambara groundnut
    'BN': 'BND'   # Dry bean
    'GB': 'BNG'   # Green bean
    'NN': 'BNN'   # Banana
    'BR': 'BRC'   # Brachiaria
    'BK': 'BWH'   # Buckwheat
    'CM': 'CAM'   # Camelina
    'C1': 'CAR'   # Carrot
    'CB': 'CBG'   # Cabbage
    #'CBY'   # Cranberry
    'C3': 'CCB'   # Chinese cabbage
    'CC': 'CCN'   # Coconut
    #'CEL'   # Celery
    'CF': 'CFE'   # Coffee
    'CG': 'CGR'   # Concord grape
    'CI': 'CHI'   # Chia
    #'CHN'   # Chestnut
    'CH': 'CHP'   # Chickpea
    'CY': 'CHR'   # Cherry
    'CT': 'CIT'   # Citrus
    #'CLF'   # Cauliflower
    'CV': 'CLV'   # Clover
    'CN': 'CNL'   # Canola
    #'COC'   # Chocolate
    'CO': 'COT'   # Cotton
    #'CRB'   # Carob
    'CR': 'CRM'   # Crambe
    'C2': 'CST'   # Castor bean
    'CS': 'CSV'   # Cassava
    #'CSW'   # Cashew
    #'CUC'   # Cucumber
    'CP': 'CWP'   # Cowpea
    #'DAT'   # Dates
    #'EGP'   # Eggplant
    #'END'   # Endive
    'BC': 'BCR'   # Carinata
    'FA': 'FAL'   # Fallow
    'FB': 'FBN'   # Faba bean
    'FG': 'FIG'   # Fig
    'FX': 'FLX'   # Flax
    #'FML'   # Finger millet
    'G0': 'FRG'   # Forage (generic)
    'MF': 'FMZ'   # Forage maize
    'FR': 'FSR'   # Red fescue
    'FM': 'FXM'   # Foxtail millet
    'GA': 'GAR'   # Garlic
    'GG': 'GGR'   # Guinea grass
    'GR': 'GRV'   # Grass vegetations
    'GW': 'GRW'   # Grass weeds
    'GU': 'GUA'   # Guayule
    'GY': 'GUR'   # Guar
    'HM': 'HMP'   # Hemp
    'HO': 'HOP'   # Hops
    #'HSP'   # Hesperaloe
    'HV': 'HVT'   # Hairy vetch
    #'HZN'   # Hazelnut
    #'JAT'   # Jatropha
    'JB': 'JBN'   # Jack bean
    'JT': 'JUT'   # Jute
    'KF': 'KNF'   # Kenaf
    #'LAB'   # Lablab
    'LB': 'LBN'   # Lima bean
    'LI': 'LCG'   # Licorice
    #'LCL'   # Licorice
    #'LEK'   # Leek
    'LT': 'LEN'   # Lentil
    #'LET'   # Lettuce
    'MZ': 'MAZ'   # Maize
    #'MCN'   # Macadamia nut
    'MU': 'MNG'   # Mung bean
    'NP': 'NPG'   # Napier grass
    'NL': 'NPL'   # Nopal
    'OS': 'OST'   # Erect prickly pear
    'NC': 'NCO'   # Cochineal nopal cactus
    'PY': 'PTY'   # Pitaya
    'DF': 'DRF'   # Dragon fruit
    'OA': 'OAT'   # Oats
    #'OKR'   # Okra
    'OP': 'OLP'   # Oil palm
    #'OLV'   # Olives
    'ON': 'ONI'   # Onion
    #'OTH'   # Other
    #'PAR'   # Parsnip
    #'PCH'   # Pak choi
    #'PCN'   # Pecan
    'PE': 'PEA'   # Pea
    'PA': 'PER'   # Pear
    'PP': 'PGP'   # Pigeon pea
    #'PLM'   # Plum
    #'PMK'   # Pumpkin
    'ML': 'PML'   # Pearl millet
    'PI': 'PNA'   # Pineapple
    'PN': 'PNT'   # Peanut
    #'POP'   # Poplar
    'PT': 'POT'   # Potato
    'PO': 'PPN'   # Perennial peanut
    'PR': 'PPR'   # Bell pepper
    #'PPY'   # Papaya
    'PM': 'PRM'   # Proso millet
    #'PRS'   # Parsley
    #'PSM'   # Persimmon
    #'PST'   # Pistachio
    'QU': 'QUN'   # Quinoa
    'RD': 'RAD'   # Radish
    'RA': 'RAP'   # Rape
    'RC': 'RCL'   # Red clover
    'RG': 'RGA'   # Annual ryegrass
    #'RGP'   # Perennial ryegrass
    'RP': 'RHP'   # Rhizoma peanut
    'RI': 'RIC'   # Rice
    'RN': 'RPN'   # Perennial rice
    'RY': 'RYE'   # Rye
    'SF': 'SAF'   # Safflower
    'SB': 'SBN'   # Soybean
    'BS': 'SBT'   # Sugar beet
    'SS': 'SES'   # Sesame
    'SG': 'SGG'   # Sorghum
    #'SHL'   # Shallot
    #'SPN'   # Spinach
    #'SQS'   # Summer squash
    #'SQW'   # Winter squash
    'SR': 'STB'   # Strawberry
    'ST': 'STR'   # Shrubs/trees
    'SV': 'STV'   # Stevia
    'SC': 'SUC'   # Sugarcane
    'SU': 'SUN'   # Sunflower
    'SW': 'SWC'   # Sweet corn
    'SI': 'SWG'   # Switch grass
    'SP': 'SWP'   # Sweet potato
    'TN': 'TAN'   # Tanier
    'TR': 'TAR'   # Taro
    'TB': 'TBN'   # Tepary bean
    #'TEA'   # Tea
    'TF': 'TEF'   # Teff
    'TS': 'TFS'   # Tall fescue
    'TG': 'TGR'   # Table grape
    #'TNP'   # Turnip
    #'TOB'   # Tobacco
    'TM': 'TOM'   # Tomato
    'TL': 'TRT'   # Triticale
    'VB': 'VBN'   # Velvet bean
    'VI': 'VIN'   # Wine grape
    'VM': 'VMG'   # Black gram
    'WH': 'WHT'   # Wheat (combining WHB and WHD as the output is the same)
    #'WIL'   # Willow
    #'WML'   # Watermelon
    #'WNB'   # Black walnut
    #'WNT'   # Walnut
    #'YAM'   # Yam
    #'ZZ1'   # Cereal-unknown or mixture
    #'ZZ2'   # Legume-unknown or mixture
    #'ZZ3'   # Grass-unknown or mixture
    #'ZZ4'   # Cover crop-unknown or mixture
  crop_name_default: &crop_name_default NA

  harvest_component_map: &harvest_component_map
    'C': 'canopy'        # Canopy
    'L': 'leaf'          # Leaves
    'H': 'harvest_product' # Harvest product (Note: consolidated from grain, silage, tuber, fruit, fiber, seed_cotton)
  harvest_component_default: &harvest_component_default NA


# =================================================================
# MAPPING RULES
# 
# Note: mapping is not exact reverse mapping of ICASA to DSSAT as
# the post-processing step (creation of DSSAT ID, nesting in file-
# level sections) is not reversed.
# =================================================================

rules:

  # TODO: ADD MISSING SECTIONS

  ## --- SECTION SOIL

  - mapping_uid: '16'
    notes: "xxx."
    source:
      section: SOIL
    target:
      section: PROFILE_METADATA

  - mapping_uid: '17'
    notes: "xxx."
    source:
      section: SOIL
    target:
      section: SOIL_PROFILE
    actions:
      # - type: lookup_and_add
      #   lookup_data_source: { section: SOIL_META }
      #   on_key: { source_key: experiment_id, lookup_key: experiment_id }
      #   select_columns:
      #     soil_classification: soil_classification
      - type: map_values
        input_map: { x: TEXTURE }
        output_header: TEXTURE
        map: *soil_texture_map
        default_value: *soil_texture_default
      - type: map_values
        input_map: { x: SMHB }
        output_header: SMHB
        map: *soil_analysis_method_codes
        default_value: *soil_ph_method_default
      - type: map_values
        input_map: { x: SMPX }
        output_header: SMPX
        map: *soil_analysis_method_codes
        default_value: *soil_p_method_default
      - type: map_values
        input_map: { x: SMKE }
        output_header: SMKE
        map: *soil_analysis_method_codes
        default_value: *soil_k_method_default

  - mapping_uid: '18'
    notes: "xxx."
    source:
      section: SOIL
    target:
      section: SOIL_PROFILE_LAYERS


# =================================================================
# SELECTING AND RENAMING
# =================================================================

  - mapping_uid: '999'
    notes: "Final schema application for all output tables."
    actions:

      - type: map_headers
        target_section: PROFILE_METADATA
        rename_map:
          experiment_id: EXP_ID  #!!
          soil_profile_ID: PEDON
          soil_site: SITE
          soil_location_country: COUNTRY
          latitude_soil_profile: LAT
          longitude_soil_profile: LONG
          # soil_notes: DESCRIPTION  # TODO: add concatenate upstream
          soil_depth: DEPTH
          soil_source: SOURCE
          soil_classification: SCS FAMILY
          soil_texture: TEXTURE
          soil_profile_methods: SL_METHODS_COMMENTS # TODO: Add soil profile notes!
          # soil_notes: SL_NOTES

      - type: map_headers
        target_section: SOIL_PROFILE
        rename_map:
          experiment_id: EXP_ID #!!
          soil_profile_ID: PEDON
          soil_albedo: SALB
          soil_evaporation_limit: SLU1
          drainage_rate_per_day: SLDR
          runoff_curve_no_SCS: SLRO
          soil_surface_color: SCOM
          mineralization_factor: SLNF
          pH_buffer_determin_meth: SMHB
          potassium_determ_method: SMKE
          phosphorus_determ_method: SMPX
          soil_fertility_on_photo: SLPF
          soil_profile_notes: SL_PROF_NOTES

      - type: map_headers
        target_section: SOIL_PROFILE_LAYERS
        rename_map:
          experiment_id: EXP_ID #!!
          soil_profile_ID: PEDON
          soil_layer_base_depth: SLB
          master_horizon: SLMH
          soil_clay_fraction: SLCL
          soil_silt_fraction: SLSI
          soil_coarse_fraction: SLCF
          soil_organic_C_perc_layr: SLOC
          soil_pH_in_buffer: SLHB
          soil_pH_in_water: SLHW
          soil_bulk_density_moist: SBDM
          soil_water_lower_limit: SLLL
          soil_wat_drned_upper_lim: SDUL
          soil_water_saturated: SSAT
          sat_hydraul_conductivity: SSKS
          cation_exchange_capacity: SCEC
          soil_organic_N_conc: SLNI
          soil_adsorption_coef: SADC
          root_growth_factor_soil: SRGF
          phosphorus_extractable: SLPX
          phosphorus_total: SLPT
          phosphorus_organic: SLPO
          phosphorus_isotherm_A: SLPA
          phosphorus_iostherm_B: SLPB
          potassium_exchangeable: SLKE
          CaCO3_content: CACO3
          soil_calcium_conc: SLCA
          soil_aluminum_conc: SLAL
          soil_iron_conc: SLFE
          soil_magnesium_conc: SLMG
          soil_manganese_conc: SLMN
          soil_sodium_conc: SLNA
          soil_sulfur_conc: SLSU
          electric_conductivity: SLEC
          soil_layer_comment: SL_LAYER_NOTES

